
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation for Triage.">
      
      
      
        <link rel="canonical" href="http://dssg.github.io/triage/dirtyduck/eis/">
      
      
        <link rel="prev" href="../problem_description/">
      
      
        <link rel="next" href="../inspections/">
      
      
      <link rel="icon" href="../../assets/images/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.4.6">
    
    
      
        <title>Early Warning System - Triage Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.35e1ed30.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:300,300i,400,400i,700,700i%7CUbuntu+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Ubuntu";--md-code-font:"Ubuntu Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../triage_docs.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="deep-orange">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#an-early-intervention-system-chicago-food-inspections" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Triage Documentation" class="md-header__button md-logo" aria-label="Triage Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 22a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2h-6v7L9.5 7.5 7 9V2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Triage Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Early Warning System
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="http://github.com/dssg/triage" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    dssg/triage
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Triage Documentation" class="md-nav__button md-logo" aria-label="Triage Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 22a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2h-6v7L9.5 7.5 7 9V2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12Z"/></svg>

    </a>
    Triage Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="http://github.com/dssg/triage" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    dssg/triage
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="https://colab.research.google.com/github/dssg/triage/blob/master/example/colab/colab_triage.ipynb" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Online Tutorial (Google Colab)
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Get started with your own project
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Get started with your own project
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../quickstart/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quickstart guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../triage_project_workflow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Suggested workflow
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Dirty Duck Tutorial
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Dirty Duck Tutorial
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome!
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../dirty_duckling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dirty duckling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" checked>
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Case studies
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Case studies
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../problem_description/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Problem description
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Early Warning System
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Early Warning System
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#problem-description" class="md-nav__link">
    Problem description
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-are-the-outcomes" class="md-nav__link">
    What are the outcomes?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-are-the-entities-of-interest-the-cohort" class="md-nav__link">
    What are the entities of interest? The cohort
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modeling-using-machine-learning" class="md-nav__link">
    Modeling Using Machine Learning
  </a>
  
    <nav class="md-nav" aria-label="Modeling Using Machine Learning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#temporal-configuration" class="md-nav__link">
    Temporal configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#features" class="md-nav__link">
    Features
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#algorithm-and-hyperparameters" class="md-nav__link">
    Algorithm and hyperparameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lets-explore-more-second-grid" class="md-nav__link">
    Let’s explore more: second grid
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#audition-so-many-models-how-can-i-choose-the-best-one" class="md-nav__link">
    Audition: So many models, how can I choose the best one?
  </a>
  
    <nav class="md-nav" aria-label="Audition: So many models, how can I choose the best one?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filtering-model-groups" class="md-nav__link">
    Filtering model groups
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#selecting-the-best-rule-or-strategy-for-choosing-model-groups" class="md-nav__link">
    Selecting the best rule or strategy for choosing model groups
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#postmodeling-inspecting-the-best-models-closely" class="md-nav__link">
    Postmodeling: Inspecting the best models closely
  </a>
  
    <nav class="md-nav" aria-label="Postmodeling: Inspecting the best models closely">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#setup" class="md-nav__link">
    Setup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#model-groups" class="md-nav__link">
    Model groups
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#going-deeper-with-a-model" class="md-nav__link">
    Going deeper with a model
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#crosstabs-how-are-the-entities-classified" class="md-nav__link">
    Crosstabs: How are the entities classified?
  </a>
  
    <nav class="md-nav" aria-label="Crosstabs: How are the entities classified?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#where-to-go-from-here" class="md-nav__link">
    Where to go from here
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../inspections/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Resource prioritization
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" >
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Triage
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            Triage
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../triage_intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    A deeper look into triage
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_5" >
        
          
          <label class="md-nav__link" for="__nav_4_5" id="__nav_4_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Are you curious about the setup?
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_5">
            <span class="md-nav__icon md-icon"></span>
            Are you curious about the setup?
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../infrastructure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Infrastructure
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../data_preparation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data preparation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../for_the_impatient/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quick setup
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Triage documentation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Triage documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Experiment
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            Experiment
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../experiments/experiment-config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Experiment Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../experiments/feature-testing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Testing Feature Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../experiments/running/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Running an Experiment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_4" >
        
          
          <label class="md-nav__link" for="__nav_5_1_4" id="__nav_5_1_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Upgrading an Experiment
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_4">
            <span class="md-nav__icon md-icon"></span>
            Upgrading an Experiment
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../experiments/upgrade-to-v8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    v7 -> v8
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../experiments/upgrade-to-v7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    v6 -> v7
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../experiments/upgrade-to-v6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    v5 -> v6
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../experiments/upgrade-to-v5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    v3/v4 -> v5
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../experiments/temporal-validation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Temporal Validation Deep Dive
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../experiments/cohort-labels/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cohort and Label Deep Dive
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../experiments/prediction-ranking/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Prediction Ranking
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../experiments/features/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Feature Generation Recipe Book
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../experiments/algorithm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Experiment Algorithm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../experiments/architecture/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Experiment Architecture
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Model selection
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Model selection
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../audition/audition_intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intro to Audition
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../audition/model_selection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model Selection Concepts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../api/audition/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Postmodeling
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            Postmodeling
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../postmodeling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using Postmodeling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../postmodeling/postmodeling-config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Postmodeling & Crosstabs Configuration
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../ml_governance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model governance
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../predictlist/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Predictlist
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../aws_batch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scaling up
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../db/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Database Provisioner
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_8" >
        
          
          <label class="md-nav__link" for="__nav_5_8" id="__nav_5_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_8">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_8_1" >
        
          
          <label class="md-nav__link" for="__nav_5_8_1" id="__nav_5_8_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Audition
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_8_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_8_1">
            <span class="md-nav__icon md-icon"></span>
            Audition
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../api/audition/auditioner/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Auditioner
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../api/audition/audition-config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Audition Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../api/audition/selection_rules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Selection Rules
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../api/audition/database-dependencies/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Database Dependencies
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#problem-description" class="md-nav__link">
    Problem description
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-are-the-outcomes" class="md-nav__link">
    What are the outcomes?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-are-the-entities-of-interest-the-cohort" class="md-nav__link">
    What are the entities of interest? The cohort
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modeling-using-machine-learning" class="md-nav__link">
    Modeling Using Machine Learning
  </a>
  
    <nav class="md-nav" aria-label="Modeling Using Machine Learning">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#temporal-configuration" class="md-nav__link">
    Temporal configuration
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#features" class="md-nav__link">
    Features
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#algorithm-and-hyperparameters" class="md-nav__link">
    Algorithm and hyperparameters
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lets-explore-more-second-grid" class="md-nav__link">
    Let’s explore more: second grid
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#audition-so-many-models-how-can-i-choose-the-best-one" class="md-nav__link">
    Audition: So many models, how can I choose the best one?
  </a>
  
    <nav class="md-nav" aria-label="Audition: So many models, how can I choose the best one?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#filtering-model-groups" class="md-nav__link">
    Filtering model groups
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#selecting-the-best-rule-or-strategy-for-choosing-model-groups" class="md-nav__link">
    Selecting the best rule or strategy for choosing model groups
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#postmodeling-inspecting-the-best-models-closely" class="md-nav__link">
    Postmodeling: Inspecting the best models closely
  </a>
  
    <nav class="md-nav" aria-label="Postmodeling: Inspecting the best models closely">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#setup" class="md-nav__link">
    Setup
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#model-groups" class="md-nav__link">
    Model groups
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#going-deeper-with-a-model" class="md-nav__link">
    Going deeper with a model
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#crosstabs-how-are-the-entities-classified" class="md-nav__link">
    Crosstabs: How are the entities classified?
  </a>
  
    <nav class="md-nav" aria-label="Crosstabs: How are the entities classified?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#where-to-go-from-here" class="md-nav__link">
    Where to go from here
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="an-early-intervention-system-chicago-food-inspections">An Early Intervention System: Chicago food inspections<a class="headerlink" href="#an-early-intervention-system-chicago-food-inspections" title="Permanent link">#</a></h1>
<div class="admonition warning">
<p class="admonition-title">Before continue, Did you…?</p>
<p>This case study, part of the dirtyduck tutorial,  assumes that you already setup the
tutorial’s infrastructure and load the dataset.</p>
<ul>
<li>
<p>If you didn’t setup the infrastructure go <a href="../infrastructure/">here</a>,</p>
</li>
<li>
<p>If you didn't load the data, you can do it very <a href="../for_the_impatient/">quickly</a>
  or you can follow all the <a href="../data_preparation/">steps and explanations about the data</a>.</p>
</li>
</ul>
</div>
<h2 id="problem-description">Problem description<a class="headerlink" href="#problem-description" title="Permanent link">#</a></h2>
<p><code>Triage</code> is designed to build, among other things, early warning systems (also called
early intervention, EIS). While there are several differences between
modeling early warnings and inspection prioritization, perhaps the
biggest differences is that the <em>entity</em> is active (i.e. it is doing stuff for
which an outcome will happen) in EIS, but passive (e.g it is inspected) in
<strong>resource prioritization</strong>. Among other things, this difference
affects the way the <em>outcome</em> is built.</p>
<p>Saying that, here's the question we want to answer:</p>
<div class="admonition quote">
<p>Will my restaurant be inspected in the next <span class="arithmatex"><span class="MathJax_Preview">Y</span><script type="math/tex">Y</script></span> period of time?</p>
</div>
<p>Where <span class="arithmatex"><span class="MathJax_Preview">X</span><script type="math/tex">X</script></span> could be 3 days, 2 months, 1 year, etc.</p>
<p>We will translate that problem to</p>
<div class="admonition quote">
<p>Will my restaurant be at the top-<span class="arithmatex"><span class="MathJax_Preview">X</span><script type="math/tex">X</script></span> facilities most likely to be
inspected in the next <span class="arithmatex"><span class="MathJax_Preview">Y</span><script type="math/tex">Y</script></span> period of time?</p>
</div>
<p>Knowing the answer to this question enables you (as the restaurant
owner or manager) to prepare for the inspection.</p>
<h2 id="what-are-the-outcomes">What are the outcomes?<a class="headerlink" href="#what-are-the-outcomes" title="Permanent link">#</a></h2>
<p>The trick to note is that on any given day there are two possible
outcomes: <em>the facility was inspected</em> and <em>the facility wasn't
inspected</em>. Our <em>outcomes</em> table will be larger than in the <a href="../inspections/">resource
prioritization</a> example because we need an <em>outcome</em> for every <em>active</em>
facility on every date. The following image tries to exemplify this
reasoning:</p>
<p><img alt="img" src="../images/outcomes-eis.png" />
<em>Figure. The image shows three facilities (blue, red and orange),
and next to each, a temporal line with 6 days (0-5). Each dot
represents the event (whether an inspection happened). Yellow means
the inspection happened (<code>TRUE</code>outcome) and blue means it didn't
(<code>FALSE</code> outcome). Each facility in the image had two inspections, six
in total.</em></p>
<p>Fortunately, <code>triage</code> will help us to create this table.</p>
<h2 id="what-are-the-entities-of-interest-the-cohort">What are the entities of interest? The <em>cohort</em><a class="headerlink" href="#what-are-the-entities-of-interest-the-cohort" title="Permanent link">#</a></h2>
<p>We are interested in predict only in <em>active</em> facilities (remember, in
this case study, you <em>own</em> a restaurant, What is the point on predict
if your restaurant is already closed for good?). This is the same
<em>cohort</em> as the <em>cohort</em> table in the <a href="../inspections/">resource
prioritization
case study</a></p>
<div class="admonition info">
<p class="admonition-title">Experiment description file</p>
<p>You could check the meaning about experiment description files
(or configuration files) in <a href="../triage_intro/"><em>A deeper look into triage</em></a>.</p>
</div>
<p>First the usual stuff. Note that we are changing <code>model_comment</code> and
<code>label_definition</code> (remember that this is used for generating the
<em>hash</em> that differentiates models and model groups).</p>
<div class="highlight"><pre><span></span><code><span class="nt">config_version</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;v8&#39;</span>

<span class="nt">model_comment</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;eis:</span><span class="nv"> </span><span class="s">01&#39;</span>
<span class="nt">random_seed</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">23895478</span>

<span class="nt">user_metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">label_definition</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;inspected&#39;</span>
<span class="w">  </span><span class="nt">experiment_type</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;eis&#39;</span>
<span class="w">  </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">    </span><span class="no">EIS 01</span>
<span class="w">  </span><span class="nt">purpose</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;model</span><span class="nv"> </span><span class="s">creation&#39;</span>
<span class="w">  </span><span class="nt">org</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;DSaPP&#39;</span>
<span class="w">  </span><span class="nt">team</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;Tutorial&#39;</span>
<span class="w">  </span><span class="nt">author</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;Your</span><span class="nv"> </span><span class="s">name</span><span class="nv"> </span><span class="s">here&#39;</span>
<span class="w">  </span><span class="nt">etl_date</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;2019-05-07&#39;</span>

<span class="nt">model_group_keys</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;class_path&#39;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;parameters&#39;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;feature_names&#39;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;feature_groups&#39;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;cohort_name&#39;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;state&#39;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;label_name&#39;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;label_timespan&#39;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;training_as_of_date_frequency&#39;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;max_training_history&#39;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;label_definition&#39;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;experiment_type&#39;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;org&#39;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;team&#39;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;author&#39;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;etl_date&#39;</span>
</code></pre></div>
<p>For the labels the query is pretty simple, if the facility showed in
the data, it will get a <em>positive</em> outcome, if not they will get a
<em>negative</em> outcome</p>
<div class="highlight"><pre><span></span><code><span class="nt">label_config</span><span class="p">:</span>
<span class="w">  </span><span class="nt">query</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">    </span><span class="no">select</span>
<span class="w">    </span><span class="no">entity_id,</span>
<span class="w">    </span><span class="no">True::integer as outcome</span>
<span class="w">    </span><span class="no">from semantic.events</span>
<span class="w">    </span><span class="no">where &#39;{as_of_date}&#39;::timestamp &lt;= date</span>
<span class="w">    </span><span class="no">and date &lt; &#39;{as_of_date}&#39;::timestamp + interval &#39;{label_timespan}&#39;</span>
<span class="w">    </span><span class="no">group by entity_id</span>
<span class="w">  </span><span class="nt">include_missing_labels_in_train_as</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">False</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;inspected&#39;</span>
</code></pre></div>
<p>Note the two introduced changes in this block, first, the <em>outcome</em> is
<code>True</code> , because all our observations represent <em>inspected</em> facilities
(see discussion above and in particular previous image), second, we
added the line <code>include_missing_labels_in_train_as: False</code>. This line
tells <code>triage</code> to incorporate all the missing facilities in the
<em>training</em> matrices with <code>False</code> as the <em>label</em>.</p>
<p>As stated we will use the same configuration block for <em>cohorts</em> that
we used in inspections:</p>
<div class="highlight"><pre><span></span><code><span class="nt">cohort_config</span><span class="p">:</span>
<span class="w">  </span><span class="nt">query</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">    </span><span class="no">select e.entity_id</span>
<span class="w">    </span><span class="no">from semantic.entities as e</span>
<span class="w">    </span><span class="no">where</span>
<span class="w">    </span><span class="no">daterange(start_time, end_time, &#39;[]&#39;) @&gt; &#39;{as_of_date}&#39;::date</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;active_facilities&#39;</span>
</code></pre></div>
<h2 id="modeling-using-machine-learning">Modeling Using Machine Learning<a class="headerlink" href="#modeling-using-machine-learning" title="Permanent link">#</a></h2>
<p>We need to specify the temporal configuration, this section should
reflect the <em>operationalization</em> of the model.</p>
<p>Let’s assume that every facility owner needs 6 months to prepare for
an inspection. So, the model needs to answer the question: <em>Will my
restaurant be inspected in the next 6 months?</em></p>
<h3 id="temporal-configuration">Temporal configuration<a class="headerlink" href="#temporal-configuration" title="Permanent link">#</a></h3>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="nt">temporal_config</span><span class="p">:</span>
<span class="w">        </span><span class="nt">feature_start_time</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;2010-01-04&#39;</span>
<span class="w">        </span><span class="nt">feature_end_time</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;2018-06-01&#39;</span>
<span class="w">        </span><span class="nt">label_start_time</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;2014-06-01&#39;</span>
<span class="w">        </span><span class="nt">label_end_time</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;2018-06-01&#39;</span>

<span class="w">        </span><span class="nt">model_update_frequency</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;6month&#39;</span>
<span class="w">        </span><span class="nt">training_label_timespans</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;6month&#39;</span><span class="p p-Indicator">]</span>
<span class="w">        </span><span class="nt">training_as_of_date_frequencies</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;6month&#39;</span>

<span class="w">        </span><span class="nt">test_durations</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;6month&#39;</span>
<span class="w">        </span><span class="nt">test_label_timespans</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;6month&#39;</span><span class="p p-Indicator">]</span>
<span class="w">        </span><span class="nt">test_as_of_date_frequencies</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;6month&#39;</span>

<span class="w">        </span><span class="nt">max_training_histories</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;5y&#39;</span>
</code></pre></div>
<p>As before, you can generate the image of the temporal blocks:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Remember to run this in bastion  NOT in your laptop shell!</span>
triage<span class="w"> </span>experiment<span class="w"> </span>experiments/eis_01.yaml<span class="w"> </span>--show-timechop
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">What? … Bastion?</p>
<p><code>bastion</code> is the docker container that contains all the setup
required to run this tutorial, if this is the first time that
you see this word, you should stop and revisit <a href="../infrastructure/">setup infrastructure</a>.</p>
</div>
<p><img alt="img" src="../images/triage/eis_01.png" />
<em>Figure. Temporal blocks for the Early Warning System. We want to
predict the most likely facilities to be inspected in the
following 6 months</em></p>
<h3 id="features">Features<a class="headerlink" href="#features" title="Permanent link">#</a></h3>
<p>Regarding the features, we will use the same ones that were used
in <a href="../inspections/">inspections prioritization</a>:</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="nt">feature_aggregations</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span>
<span class="w">        </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;inspections&#39;</span>
<span class="w">        </span><span class="nt">from_obj</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;semantic.events&#39;</span>
<span class="w">        </span><span class="nt">knowledge_date_column</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;date&#39;</span>

<span class="w">        </span><span class="nt">aggregates_imputation</span><span class="p">:</span>
<span class="w">          </span><span class="nt">count</span><span class="p">:</span>
<span class="w">            </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;zero_noflag&#39;</span>

<span class="w">        </span><span class="nt">aggregates</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span>
<span class="w">            </span><span class="nt">quantity</span><span class="p">:</span>
<span class="w">              </span><span class="nt">total</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;*&quot;</span>
<span class="w">            </span><span class="nt">metrics</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;count&#39;</span>

<span class="w">        </span><span class="nt">intervals</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;1month&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;3month&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;6month&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;1y&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;all&#39;</span><span class="p p-Indicator">]</span>

<span class="w">      </span><span class="p p-Indicator">-</span>
<span class="w">        </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;risks&#39;</span>
<span class="w">        </span><span class="nt">from_obj</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;semantic.events&#39;</span>
<span class="w">        </span><span class="nt">knowledge_date_column</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;date&#39;</span>

<span class="w">        </span><span class="nt">categoricals_imputation</span><span class="p">:</span>
<span class="w">          </span><span class="nt">sum</span><span class="p">:</span>
<span class="w">            </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;zero&#39;</span>
<span class="w">          </span><span class="nt">avg</span><span class="p">:</span>
<span class="w">            </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;zero&#39;</span>

<span class="w">        </span><span class="nt">categoricals</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span>
<span class="w">            </span><span class="nt">column</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;risk&#39;</span>
<span class="w">            </span><span class="nt">choices</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;low&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;medium&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;high&#39;</span><span class="p p-Indicator">]</span>
<span class="w">            </span><span class="nt">metrics</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;sum&#39;</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;avg&#39;</span>

<span class="w">        </span><span class="nt">intervals</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;1month&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;3month&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;6month&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;1y&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;all&#39;</span><span class="p p-Indicator">]</span>

<span class="w">      </span><span class="p p-Indicator">-</span>
<span class="w">        </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;results&#39;</span>
<span class="w">        </span><span class="nt">from_obj</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;semantic.events&#39;</span>
<span class="w">        </span><span class="nt">knowledge_date_column</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;date&#39;</span>

<span class="w">        </span><span class="nt">categoricals_imputation</span><span class="p">:</span>
<span class="w">          </span><span class="nt">all</span><span class="p">:</span>
<span class="w">            </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;zero&#39;</span>

<span class="w">        </span><span class="nt">categoricals</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span>
<span class="w">            </span><span class="nt">column</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;result&#39;</span>
<span class="w">            </span><span class="nt">choice_query</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;select</span><span class="nv"> </span><span class="s">distinct</span><span class="nv"> </span><span class="s">result</span><span class="nv"> </span><span class="s">from</span><span class="nv"> </span><span class="s">semantic.events&#39;</span>
<span class="w">            </span><span class="nt">metrics</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;sum&#39;</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;avg&#39;</span>

<span class="w">        </span><span class="nt">intervals</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;1month&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;3month&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;6month&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;1y&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;all&#39;</span><span class="p p-Indicator">]</span>

<span class="w">      </span><span class="p p-Indicator">-</span>
<span class="w">        </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;inspection_types&#39;</span>
<span class="w">        </span><span class="nt">from_obj</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;semantic.events&#39;</span>
<span class="w">        </span><span class="nt">knowledge_date_column</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;date&#39;</span>

<span class="w">        </span><span class="nt">categoricals_imputation</span><span class="p">:</span>
<span class="w">          </span><span class="nt">sum</span><span class="p">:</span>
<span class="w">            </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;zero_noflag&#39;</span>

<span class="w">        </span><span class="nt">categoricals</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span>
<span class="w">            </span><span class="nt">column</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;type&#39;</span>
<span class="w">            </span><span class="nt">choice_query</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;select</span><span class="nv"> </span><span class="s">distinct</span><span class="nv"> </span><span class="s">type</span><span class="nv"> </span><span class="s">from</span><span class="nv"> </span><span class="s">semantic.events</span><span class="nv"> </span><span class="s">where</span><span class="nv"> </span><span class="s">type</span><span class="nv"> </span><span class="s">is</span><span class="nv"> </span><span class="s">not</span><span class="nv"> </span><span class="s">null&#39;</span>
<span class="w">            </span><span class="nt">metrics</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;sum&#39;</span>

<span class="w">        </span><span class="nt">intervals</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;1month&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;3month&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;6month&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;1y&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;all&#39;</span><span class="p p-Indicator">]</span>
</code></pre></div>
<p>We specify that we want to use all possible feature-group combinations for training:</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="nt">feature_group_definition</span><span class="p">:</span>
<span class="w">       </span><span class="nt">prefix</span><span class="p">:</span>
<span class="w">         </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;inspections&#39;</span>
<span class="w">         </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;results&#39;</span>
<span class="w">         </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;risks&#39;</span>
<span class="w">         </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;inspection_types&#39;</span>

<span class="w">    </span><span class="nt">feature_group_strategies</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;all&#39;</span><span class="p p-Indicator">]</span>
</code></pre></div>
<p>i.e. <code>all</code> will train models with all the features groups,
<code>leave-one-in</code> will use only one of the feature groups for
traning, and lastly, <code>leave-one-out</code> will train the model with all
the features except one.</p>
<h3 id="algorithm-and-hyperparameters">Algorithm and hyperparameters<a class="headerlink" href="#algorithm-and-hyperparameters" title="Permanent link">#</a></h3>
<p>We will begin defining some basic models as baselines.</p>
<div class="highlight"><pre><span></span><code><span class="s">&#39;triage.component.catwalk.baselines.thresholders.SimpleThresholder&#39;</span><span class="p p-Indicator">:</span>
<span class="w">  </span><span class="nt">rules</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;inspections_entity_id_1month_total_count</span><span class="nv"> </span><span class="s">&gt;</span><span class="nv"> </span><span class="s">0&#39;</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;results_entity_id_1month_result_fail_sum</span><span class="nv"> </span><span class="s">&gt;</span><span class="nv"> </span><span class="s">0&#39;</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;risks_entity_id_1month_risk_high_sum</span><span class="nv"> </span><span class="s">&gt;</span><span class="nv"> </span><span class="s">0&#39;</span><span class="p p-Indicator">]</span>

<span class="s">&#39;triage.component.catwalk.baselines.rankers.PercentileRankOneFeature&#39;</span><span class="p p-Indicator">:</span>
<span class="w">  </span><span class="nt">feature</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;risks_entity_id_all_risk_high_sum&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;inspections_entity_id_all_total_count&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;results_entity_id_all_result_fail_sum&#39;</span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="nt">low_value_high_score</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">True</span><span class="p p-Indicator">]</span>

<span class="s">&#39;sklearn.dummy.DummyClassifier&#39;</span><span class="p p-Indicator">:</span>
<span class="w">  </span><span class="nt">strategy</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;prior&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;stratified&#39;</span><span class="p p-Indicator">]</span>

<span class="s">&#39;sklearn.tree.DecisionTreeClassifier&#39;</span><span class="p p-Indicator">:</span>
<span class="w">  </span><span class="nt">criterion</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;gini&#39;</span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="nt">max_features</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;sqrt&#39;</span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="nt">max_depth</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="nv">2</span><span class="p p-Indicator">,</span><span class="nv">5</span><span class="p p-Indicator">,</span><span class="nv">~</span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="nt">min_samples_split</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">2</span><span class="p p-Indicator">]</span>

<span class="s">&#39;triage.component.catwalk.estimators.classifiers.ScaledLogisticRegression&#39;</span><span class="p p-Indicator">:</span>
<span class="w">  </span><span class="nt">penalty</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;l1&#39;</span><span class="p p-Indicator">,</span><span class="s">&#39;l2&#39;</span><span class="p p-Indicator">]</span>
<span class="w">  </span><span class="nt">C</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">0.000001</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">0.0001</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">0.01</span><span class="p p-Indicator">,</span><span class="w">  </span><span class="nv">1.0</span><span class="p p-Indicator">]</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">How did I know the name of the features?</p>
<p><code>triage</code> has a very useful utility called <code>featuretest</code></p>
<div class="highlight"><pre><span></span><code><span class="w">    </span>triage<span class="w"> </span>featuretest<span class="w"> </span>experiments/eis_01.yaml<span class="w"> </span><span class="m">2018</span>-01-01
</code></pre></div>
<p>You can use for testing the definition of your features and also
to see if the way that the features are calculated is actually
what do you expect.</p>
<p>Here we are using it just to check the name of the generated features.</p>
</div>
<p><code>triage</code> will create <strong>20</strong> <em>model groups</em>: algorithms and
hyperparameters (4 <code>DecisionTreeClassifier</code>, 8
<code>ScaledLogisticRegression</code>, 2 <code>DummyClassifier</code>, 3 <code>SimpleThresholder</code>
and 3 <code>PercentileRankOneFeature</code>) &times; <strong>1</strong>
features sets (1 <code>all</code>). The
total number of <em>models</em> is three times that (we have 6 time
blocks, so <strong>120</strong> models).</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="nt">scoring</span><span class="p">:</span>
<span class="w">        </span><span class="nt">testing_metric_groups</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span>
<span class="w">              </span><span class="nt">metrics</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">precision@</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">recall@</span><span class="p p-Indicator">]</span>
<span class="w">              </span><span class="nt">thresholds</span><span class="p">:</span>
<span class="w">                </span><span class="nt">percentiles</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">1.0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">2.0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">3.0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">4.0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">5.0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">10</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">15</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">20</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">25</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">30</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">35</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">40</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">45</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">50</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">55</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">60</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">65</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">70</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">75</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">80</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">85</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">90</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">95</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">100</span><span class="p p-Indicator">]</span>
<span class="w">                </span><span class="nt">top_n</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">5</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">10</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">25</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">50</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">100</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">250</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">500</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1000</span><span class="p p-Indicator">]</span>


<span class="w">        </span><span class="nt">training_metric_groups</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span>
<span class="w">            </span><span class="nt">metrics</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">accuracy</span><span class="p p-Indicator">]</span>
<span class="w">          </span><span class="p p-Indicator">-</span>
<span class="w">            </span><span class="nt">metrics</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">precision@</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">recall@</span><span class="p p-Indicator">]</span>
<span class="w">            </span><span class="nt">thresholds</span><span class="p">:</span>
<span class="w">              </span><span class="nt">percentiles</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">1.0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">2.0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">3.0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">4.0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">5.0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">10</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">15</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">20</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">25</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">30</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">35</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">40</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">45</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">50</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">55</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">60</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">65</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">70</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">75</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">80</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">85</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">90</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">95</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">100</span><span class="p p-Indicator">]</span>
<span class="w">              </span><span class="nt">top_n</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">1</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">5</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">10</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">25</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">50</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">100</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">250</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">500</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1000</span><span class="p p-Indicator">]</span>
</code></pre></div>
<p>As a last step, we validate that the configuration file is correct:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Remember to run this in bastion  NOT in your laptop shell!</span>
triage<span class="w"> </span>experiment<span class="w"> </span>experiments/eis_01.yaml<span class="w">  </span>--validate-only
</code></pre></div>
<p>And then just run it:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Remember to run this in bastion  NOT in your laptop shell!</span>
<span class="nb">time</span><span class="w"> </span>triage<span class="w"> </span>experiment<span class="w"> </span>experiments/eis_01.yaml
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Protip</p>
<p>We are including the command <code>time</code> in order to get the total
running time of the experiment. You can remove it, if you like.</p>
</div>
<p>This will take a <strong>lot</strong> amount of time (on my computer took 3h
42m), so, grab your coffee, chat with your coworkers, check your
email, or read the <a href="https://dssg.uchicago.edu/blog">DSSG blog</a>. It's
taking that long for several reasons:</p>
<ol>
<li>There are a lot of models, parameters, etc.</li>
<li>We are running in serial mode (i.e. not in parallel).</li>
<li>The database is running on your laptop.</li>
</ol>
<p>You can solve 2 and 3. For the second point you could use the
<code>docker</code> container that has the multicore option enabled. For 3, I
recommed you to use a PostgreSQL database in the cloud, such as
Amazon's <strong>PostgreSQL RDS</strong> (we will explore this later in running
triage in AWS Batch).</p>
<p>After the experiment finishes, we can create the following table:</p>
<div class="highlight"><pre><span></span><code><span class="w">    </span><span class="k">with</span><span class="w"> </span><span class="n">features_groups</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="n">model_group_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">split_part</span><span class="p">(</span><span class="k">unnest</span><span class="p">(</span><span class="n">feature_list</span><span class="p">),</span><span class="w"> </span><span class="s1">&#39;_&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">feature_groups</span>
<span class="w">    </span><span class="k">from</span>
<span class="w">        </span><span class="n">triage_metadata</span><span class="p">.</span><span class="n">model_groups</span>
<span class="w">    </span><span class="p">),</span>

<span class="w">    </span><span class="n">features_arrays</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="n">model_group_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">array_agg</span><span class="p">(</span><span class="k">distinct</span><span class="w"> </span><span class="n">feature_groups</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">feature_groups</span>
<span class="w">    </span><span class="k">from</span>
<span class="w">        </span><span class="n">features_groups</span>
<span class="w">    </span><span class="k">group</span><span class="w"> </span><span class="k">by</span>
<span class="w">        </span><span class="n">model_group_id</span>
<span class="w">    </span><span class="p">)</span>

<span class="w">    </span><span class="k">select</span>
<span class="w">        </span><span class="n">model_group_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">regexp_replace</span><span class="p">(</span><span class="n">model_type</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;^.*\.&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">model_type</span><span class="p">,</span>
<span class="w">        </span><span class="n">hyperparameters</span><span class="p">,</span>
<span class="w">        </span><span class="n">feature_groups</span><span class="p">,</span>
<span class="w">        </span><span class="n">array_agg</span><span class="p">(</span><span class="n">model_id</span><span class="w"> </span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">train_end_time</span><span class="w"> </span><span class="k">asc</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">models</span><span class="p">,</span>
<span class="w">        </span><span class="n">array_agg</span><span class="p">(</span><span class="n">train_end_time</span><span class="p">::</span><span class="nb">date</span><span class="w"> </span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">train_end_time</span><span class="w"> </span><span class="k">asc</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">times</span><span class="p">,</span>
<span class="w">        </span><span class="n">array_agg</span><span class="p">(</span><span class="n">to_char</span><span class="p">(</span><span class="n">stochastic_value</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;0.999&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">order</span><span class="w"> </span><span class="k">by</span>
<span class="w">    </span><span class="n">train_end_time</span><span class="w"> </span><span class="k">asc</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="ss">&quot;precision@10% (stochastic)&quot;</span>
<span class="w">    </span><span class="k">from</span>
<span class="w">        </span><span class="n">triage_metadata</span><span class="p">.</span><span class="n">models</span>
<span class="w">        </span><span class="k">join</span>
<span class="w">        </span><span class="n">features_arrays</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">model_group_id</span><span class="p">)</span>
<span class="w">        </span><span class="k">join</span>
<span class="w">        </span><span class="n">test_results</span><span class="p">.</span><span class="n">evaluations</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">model_id</span><span class="p">)</span>
<span class="w">    </span><span class="k">where</span>
<span class="w">        </span><span class="n">model_comment</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="s1">&#39;eis&#39;</span>
<span class="w">        </span><span class="k">and</span>
<span class="w">        </span><span class="n">metric</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;precision@10_pct&#39;</span>
<span class="w">    </span><span class="k">group</span><span class="w"> </span><span class="k">by</span>
<span class="w">        </span><span class="n">model_group_id</span><span class="p">,</span>
<span class="w">        </span><span class="n">model_type</span><span class="p">,</span>
<span class="w">        </span><span class="n">hyperparameters</span><span class="p">,</span>
<span class="w">        </span><span class="n">feature_groups</span>
<span class="w">    </span><span class="k">order</span><span class="w"> </span><span class="k">by</span>
<span class="w">        </span><span class="n">model_group_id</span><span class="p">;</span>
</code></pre></div>
<table>
<thead>
<tr>
<th>model_group_id</th>
<th>model_type</th>
<th>hyperparameters</th>
<th>feature_groups</th>
<th>models</th>
<th>times</th>
<th>precision@10% (stochastic)</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>SimpleThresholder</td>
<td>{"rules": ["inspections_entity_id_1month_total_count &gt; 0"]}</td>
<td>{inspection,inspections,results,risks}</td>
<td>{1,19,37,55,73,91}</td>
<td>{2014-12-01,2015-06-01,2015-12-01,2016-06-01,2016-12-01,2017-06-01}</td>
<td>{" 0.358"," 0.231"," 0.321"," 0.267"," 0.355"," 0.239"}</td>
</tr>
<tr>
<td>2</td>
<td>SimpleThresholder</td>
<td>{"rules": ["results_entity_id_1month_result_fail_sum &gt; 0"]}</td>
<td>{inspection,inspections,results,risks}</td>
<td>{2,20,38,56,74,92}</td>
<td>{2014-12-01,2015-06-01,2015-12-01,2016-06-01,2016-12-01,2017-06-01}</td>
<td>{" 0.316"," 0.316"," 0.323"," 0.344"," 0.330"," 0.312"}</td>
</tr>
<tr>
<td>3</td>
<td>SimpleThresholder</td>
<td>{"rules": ["risks_entity_id_1month_risk_high_sum &gt; 0"]}</td>
<td>{inspection,inspections,results,risks}</td>
<td>{3,21,39,57,75,93}</td>
<td>{2014-12-01,2015-06-01,2015-12-01,2016-06-01,2016-12-01,2017-06-01}</td>
<td>{" 0.364"," 0.248"," 0.355"," 0.286"," 0.371"," 0.257"}</td>
</tr>
<tr>
<td>4</td>
<td>PercentileRankOneFeature</td>
<td>{"low_value_high_score": true, "feature": "risks_entity_id_all_risk_high_sum"}</td>
<td>{inspection,inspections,results,risks}</td>
<td>{4,22,40,58,76,94}</td>
<td>{2014-12-01,2015-06-01,2015-12-01,2016-06-01,2016-12-01,2017-06-01}</td>
<td>{" 0.121"," 0.193"," 0.124"," 0.230"," 0.112"," 0.161"}</td>
</tr>
<tr>
<td>5</td>
<td>PercentileRankOneFeature</td>
<td>{"low_value_high_score": true, "feature": "inspections_entity_id_all_total_count"}</td>
<td>{inspection,inspections,results,risks}</td>
<td>{5,23,41,59,77,95}</td>
<td>{2014-12-01,2015-06-01,2015-12-01,2016-06-01,2016-12-01,2017-06-01}</td>
<td>{" 0.076"," 0.133"," 0.098"," 0.101"," 0.086"," 0.082"}</td>
</tr>
<tr>
<td>6</td>
<td>PercentileRankOneFeature</td>
<td>{"low_value_high_score": true, "feature": "results_entity_id_all_result_fail_sum"}</td>
<td>{inspection,inspections,results,risks}</td>
<td>{6,24,42,60,78,96}</td>
<td>{2014-12-01,2015-06-01,2015-12-01,2016-06-01,2016-12-01,2017-06-01}</td>
<td>{" 0.237"," 0.274"," 0.250"," 0.275"," 0.225"," 0.221"}</td>
</tr>
<tr>
<td>7</td>
<td>DecisionTreeClassifier</td>
<td>{"criterion": "gini", "max_depth": 1, "max_features": "sqrt", "min_samples_split": 2}</td>
<td>{inspection,inspections,results,risks}</td>
<td>{7,25,43,61,79,97}</td>
<td>{2014-12-01,2015-06-01,2015-12-01,2016-06-01,2016-12-01,2017-06-01}</td>
<td>{" 0.284"," 0.441"," 0.559"," 0.479"," 0.463"," 0.412"}</td>
</tr>
<tr>
<td>8</td>
<td>DecisionTreeClassifier</td>
<td>{"criterion": "gini", "max_depth": 2, "max_features": "sqrt", "min_samples_split": 2}</td>
<td>{inspection,inspections,results,risks}</td>
<td>{8,26,44,62,80,98}</td>
<td>{2014-12-01,2015-06-01,2015-12-01,2016-06-01,2016-12-01,2017-06-01}</td>
<td>{" 0.401"," 0.388"," 0.533"," 0.594"," 0.519"," 0.649"}</td>
</tr>
<tr>
<td>9</td>
<td>DecisionTreeClassifier</td>
<td>{"criterion": "gini", "max_depth": 5, "max_features": "sqrt", "min_samples_split": 2}</td>
<td>{inspection,inspections,results,risks}</td>
<td>{9,27,45,63,81,99}</td>
<td>{2014-12-01,2015-06-01,2015-12-01,2016-06-01,2016-12-01,2017-06-01}</td>
<td>{" 0.594"," 0.876"," 0.764"," 0.843"," 0.669"," 0.890"}</td>
</tr>
<tr>
<td>10</td>
<td>DecisionTreeClassifier</td>
<td>{"criterion": "gini", "max_depth": null, "max_features": "sqrt", "min_samples_split": 2}</td>
<td>{inspection,inspections,results,risks}</td>
<td>{10,28,46,64,82,100}</td>
<td>{2014-12-01,2015-06-01,2015-12-01,2016-06-01,2016-12-01,2017-06-01}</td>
<td>{" 0.484"," 0.542"," 0.566"," 0.589"," 0.565"," 0.546"}</td>
</tr>
<tr>
<td>11</td>
<td>ScaledLogisticRegression</td>
<td>{"C": 0.000001, "penalty": "l1"}</td>
<td>{inspection,inspections,results,risks}</td>
<td>{11,29,47,65,83,101}</td>
<td>{2014-12-01,2015-06-01,2015-12-01,2016-06-01,2016-12-01,2017-06-01}</td>
<td>{" 0.272"," 0.318"," 0.306"," 0.328"," 0.292"," 0.281"}</td>
</tr>
<tr>
<td>12</td>
<td>ScaledLogisticRegression</td>
<td>{"C": 0.000001, "penalty": "l2"}</td>
<td>{inspection,inspections,results,risks}</td>
<td>{12,30,48,66,84,102}</td>
<td>{2014-12-01,2015-06-01,2015-12-01,2016-06-01,2016-12-01,2017-06-01}</td>
<td>{" 0.382"," 0.187"," 0.375"," 0.261"," 0.419"," 0.233"}</td>
</tr>
<tr>
<td>13</td>
<td>ScaledLogisticRegression</td>
<td>{"C": 0.0001, "penalty": "l1"}</td>
<td>{inspection,inspections,results,risks}</td>
<td>{13,31,49,67,85,103}</td>
<td>{2014-12-01,2015-06-01,2015-12-01,2016-06-01,2016-12-01,2017-06-01}</td>
<td>{" 0.275"," 0.314"," 0.306"," 0.329"," 0.462"," 0.421"}</td>
</tr>
<tr>
<td>14</td>
<td>ScaledLogisticRegression</td>
<td>{"C": 0.0001, "penalty": "l2"}</td>
<td>{inspection,inspections,results,risks}</td>
<td>{14,32,50,68,86,104}</td>
<td>{2014-12-01,2015-06-01,2015-12-01,2016-06-01,2016-12-01,2017-06-01}</td>
<td>{" 0.562"," 0.454"," 0.765"," 0.821"," 0.758"," 0.828"}</td>
</tr>
<tr>
<td>15</td>
<td>ScaledLogisticRegression</td>
<td>{"C": 0.01, "penalty": "l1"}</td>
<td>{inspection,inspections,results,risks}</td>
<td>{15,33,51,69,87,105}</td>
<td>{2014-12-01,2015-06-01,2015-12-01,2016-06-01,2016-12-01,2017-06-01}</td>
<td>{" 0.745"," 0.863"," 0.807"," 0.867"," 0.826"," 0.873"}</td>
</tr>
<tr>
<td>16</td>
<td>ScaledLogisticRegression</td>
<td>{"C": 0.01, "penalty": "l2"}</td>
<td>{inspection,inspections,results,risks}</td>
<td>{16,34,52,70,88,106}</td>
<td>{2014-12-01,2015-06-01,2015-12-01,2016-06-01,2016-12-01,2017-06-01}</td>
<td>{" 0.739"," 0.863"," 0.793"," 0.870"," 0.822"," 0.874"}</td>
</tr>
<tr>
<td>17</td>
<td>ScaledLogisticRegression</td>
<td>{"C": 1.0, "penalty": "l1"}</td>
<td>{inspection,inspections,results,risks}</td>
<td>{17,35,53,71,89,107}</td>
<td>{2014-12-01,2015-06-01,2015-12-01,2016-06-01,2016-12-01,2017-06-01}</td>
<td>{" 0.706"," 0.769"," 0.796"," 0.846"," 0.822"," 0.868"}</td>
</tr>
<tr>
<td>18</td>
<td>ScaledLogisticRegression</td>
<td>{"C": 1.0, "penalty": "l2"}</td>
<td>{inspection,inspections,results,risks}</td>
<td>{18,36,54,72,90,108}</td>
<td>{2014-12-01,2015-06-01,2015-12-01,2016-06-01,2016-12-01,2017-06-01}</td>
<td>{" 0.694"," 0.779"," 0.793"," 0.845"," 0.823"," 0.867"}</td>
</tr>
<tr>
<td>19</td>
<td>DummyClassifier</td>
<td>{"strategy": "prior"}</td>
<td>{inspection,inspections,results,risks}</td>
<td>{109,111,113,115,117,119}</td>
<td>{2014-12-01,2015-06-01,2015-12-01,2016-06-01,2016-12-01,2017-06-01}</td>
<td>{" 0.273"," 0.316"," 0.306"," 0.332"," 0.295"," 0.282"}</td>
</tr>
<tr>
<td>20</td>
<td>DummyClassifier</td>
<td>{"strategy": "stratified"}</td>
<td>{inspection,inspections,results,risks}</td>
<td>{110,112,114,116,118,120}</td>
<td>{2014-12-01,2015-06-01,2015-12-01,2016-06-01,2016-12-01,2017-06-01}</td>
<td>{" 0.272"," 0.314"," 0.301"," 0.343"," 0.292"," 0.287"}</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Protip</p>
<p>You could have a "real time" version of the previous query while
you are running the experiment config file with triage. Just
execute <code>\watch n</code> in the <code>psql</code> console and it will be refreshed
every <span class="arithmatex"><span class="MathJax_Preview">n</span><script type="math/tex">n</script></span> seconds</p>
</div>
<h2 id="lets-explore-more-second-grid">Let’s explore more: second grid<a class="headerlink" href="#lets-explore-more-second-grid" title="Permanent link">#</a></h2>
<p>After the <em>baseline</em> we will explore a more robust set of
algorithms. We will use a different experiment config file:
<code>eis_02.yaml</code>.</p>
<p>The only differences between this experiment config file and the
previous are in the <code>user_metadata</code> section:</p>
<div class="highlight"><pre><span></span><code><span class="nt">config_version</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;v8&#39;</span>

<span class="nt">model_comment</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;eis:</span><span class="nv"> </span><span class="s">02&#39;</span>
<span class="nt">random_seed</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">23895478</span>

<span class="nt">user_metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">label_definition</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;inspected&#39;</span>
<span class="w">  </span><span class="nt">experiment_type</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;eis&#39;</span>
<span class="w">  </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">    </span><span class="no">EIS 02</span>
<span class="w">  </span><span class="nt">purpose</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;model</span><span class="nv"> </span><span class="s">creation&#39;</span>
<span class="w">  </span><span class="nt">org</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;DSaPP&#39;</span>
<span class="w">  </span><span class="nt">team</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;Tutorial&#39;</span>
<span class="w">  </span><span class="nt">author</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;Your</span><span class="nv"> </span><span class="s">name</span><span class="nv"> </span><span class="s">here&#39;</span>
<span class="w">  </span><span class="nt">etl_date</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;2019-05-07&#39;</span>
</code></pre></div>
<p>and in the <code>grid_config</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">grid_config</span><span class="p">:</span>
<span class="w">    </span><span class="c1">## Boosting</span>
<span class="w">   </span><span class="s">&#39;sklearn.ensemble.AdaBoostClassifier&#39;</span><span class="p p-Indicator">:</span>
<span class="w">     </span><span class="nt">n_estimators</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">1000</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">2000</span><span class="p p-Indicator">]</span>

<span class="w">   </span><span class="s">&#39;sklearn.ensemble.GradientBoostingClassifier&#39;</span><span class="p p-Indicator">:</span>
<span class="w">     </span><span class="nt">n_estimators</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">1000</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">2000</span><span class="p p-Indicator">]</span>
<span class="w">     </span><span class="nt">learning_rate </span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">0.01</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1.0</span><span class="p p-Indicator">]</span>
<span class="w">     </span><span class="nt">subsample</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">0.5</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">1.0</span><span class="p p-Indicator">]</span>
<span class="w">     </span><span class="nt">min_samples_split</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">2</span><span class="p p-Indicator">]</span>
<span class="w">     </span><span class="nt">max_depth</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">2</span><span class="p p-Indicator">,</span><span class="nv">5</span><span class="p p-Indicator">]</span>

<span class="w">   </span><span class="c1">## Forest</span>
<span class="w">   </span><span class="s">&#39;sklearn.tree.DecisionTreeClassifier&#39;</span><span class="p p-Indicator">:</span>
<span class="w">     </span><span class="nt">criterion</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;gini&#39;</span><span class="p p-Indicator">]</span>
<span class="w">     </span><span class="nt">max_depth</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">5</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">10</span><span class="p p-Indicator">]</span>
<span class="w">     </span><span class="nt">min_samples_split</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">10</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">50</span><span class="p p-Indicator">]</span>

<span class="w">   </span><span class="s">&#39;sklearn.ensemble.RandomForestClassifier&#39;</span><span class="p p-Indicator">:</span>
<span class="w">     </span><span class="nt">n_estimators</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">10000</span><span class="p p-Indicator">]</span>
<span class="w">     </span><span class="nt">criterion</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;gini&#39;</span><span class="p p-Indicator">]</span>
<span class="w">     </span><span class="nt">max_depth</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">5</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">10</span><span class="p p-Indicator">]</span>
<span class="w">     </span><span class="nt">max_features</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;sqrt&#39;</span><span class="p p-Indicator">]</span>
<span class="w">     </span><span class="nt">min_samples_split</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">10</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">50</span><span class="p p-Indicator">]</span>
<span class="w">     </span><span class="nt">n_jobs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-1</span><span class="p p-Indicator">]</span>

<span class="w">   </span><span class="s">&#39;sklearn.ensemble.ExtraTreesClassifier&#39;</span><span class="p p-Indicator">:</span>
<span class="w">     </span><span class="nt">n_estimators</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">10000</span><span class="p p-Indicator">]</span>
<span class="w">     </span><span class="nt">criterion</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;gini&#39;</span><span class="p p-Indicator">]</span>
<span class="w">     </span><span class="nt">max_depth</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">5</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">10</span><span class="p p-Indicator">]</span>
<span class="w">     </span><span class="nt">max_features</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;sqrt&#39;</span><span class="p p-Indicator">]</span>
<span class="w">     </span><span class="nt">min_samples_split</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">2</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">10</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">50</span><span class="p p-Indicator">]</span>
<span class="w">     </span><span class="nt">n_jobs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">-1</span><span class="p p-Indicator">]</span>
</code></pre></div>
<p>This new experiment configuration file will add <strong>37</strong> models groups to our experiment.</p>
<p>You can run this experiment with:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Remember to run this in bastion  NOT in your laptop shell!</span>
<span class="nb">time</span><span class="w"> </span>triage<span class="w"> </span>experiment<span class="w"> </span>experiments/eis_02.yaml
</code></pre></div>
<h2 id="audition-so-many-models-how-can-i-choose-the-best-one">Audition: So many models, how can I choose the best one?<a class="headerlink" href="#audition-so-many-models-how-can-i-choose-the-best-one" title="Permanent link">#</a></h2>
<p>Let’s select the best model groups, using Audition. We need to make
small changes to the <code>/triage/audition/eis_audition_config.yaml</code>
compared to the inspection’s one:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># CHOOSE MODEL GROUPS</span>
<span class="nt">model_groups</span><span class="p">:</span>
<span class="w">    </span><span class="nt">query</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">        </span><span class="no">select distinct(model_group_id)</span>
<span class="w">        </span><span class="no">from triage_metadata.model_groups</span>
<span class="w">        </span><span class="no">where model_config -&gt;&gt; &#39;experiment_type&#39; ~ &#39;eis&#39;</span>
<span class="c1"># CHOOSE TIMESTAMPS/TRAIN END TIMES</span>
<span class="nt">time_stamps</span><span class="p">:</span>
<span class="w">    </span><span class="nt">query</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">        </span><span class="no">select distinct train_end_time</span>
<span class="w">        </span><span class="no">from triage_metadata.models</span>
<span class="w">        </span><span class="no">where model_group_id in ({})</span>
<span class="w">        </span><span class="no">and extract(day from train_end_time) in (1)</span>
<span class="w">        </span><span class="no">and train_end_time &gt;= &#39;2014-01-01&#39;</span>
<span class="c1"># FILTER</span>
<span class="nt">filter</span><span class="p">:</span>
<span class="w">    </span><span class="nt">metric</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;precision@&#39;</span><span class="w"> </span><span class="c1"># metric of interest</span>
<span class="w">    </span><span class="nt">parameter</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;10_pct&#39;</span><span class="w"> </span><span class="c1"># parameter of interest</span>
<span class="w">    </span><span class="nt">max_from_best</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0</span><span class="w"> </span><span class="c1"># The maximum value that the given metric can be worse than the best model for a given train end time.</span>
<span class="w">    </span><span class="nt">threshold_value</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0</span><span class="w"> </span><span class="c1"># The worst absolute value that the given metric should be.</span>
<span class="w">    </span><span class="nt">distance_table</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;eis_distance_table&#39;</span><span class="w"> </span><span class="c1"># name of the distance table</span>
<span class="w">    </span><span class="nt">models_table</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;models&#39;</span><span class="w"> </span><span class="c1"># name of the models table</span>

<span class="c1"># RULES</span>
<span class="nt">rules</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span>
<span class="w">        </span><span class="nt">shared_parameters</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span>
<span class="w">                </span><span class="nt">metric</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;precision@&#39;</span>
<span class="w">                </span><span class="nt">parameter</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;10_pct&#39;</span>

<span class="w">        </span><span class="nt">selection_rules</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span>
<span class="w">                </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;best_current_value&#39;</span><span class="w"> </span><span class="c1"># Pick the model group with the best current metric value</span>
<span class="w">                </span><span class="nt">n</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="w">            </span><span class="p p-Indicator">-</span>
<span class="w">                </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;best_average_value&#39;</span><span class="w"> </span><span class="c1"># Pick the model with the highest average metric value</span>
<span class="w">                </span><span class="nt">n</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="w">            </span><span class="p p-Indicator">-</span>
<span class="w">                </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;lowest_metric_variance&#39;</span><span class="w"> </span><span class="c1"># Pick the model with the lowest metric variance</span>
<span class="w">                </span><span class="nt">n</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="w">            </span><span class="p p-Indicator">-</span>
<span class="w">                </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;most_frequent_best_dist&#39;</span><span class="w"> </span><span class="c1"># Pick the model that is most frequently within `dist_from_best_case`</span>
<span class="w">                </span><span class="nt">dist_from_best_case</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">0.05</span><span class="p p-Indicator">]</span>
<span class="w">                </span><span class="nt">n</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
</code></pre></div>
<p>And then we run the simulation of the rules againts the experiment as:</p>
<div class="highlight"><pre><span></span><code>triage<span class="w"> </span>audition<span class="w"> </span>-c<span class="w"> </span>./audition/eis_audition_config.yaml<span class="w"> </span>--directory<span class="w"> </span>audition/eis
</code></pre></div>
<p><code>Audition</code> will create several plots that will help you to sort out
which is the <em>best</em> model group to use (like in a production setting
or just to generate your list).</p>
<h3 id="filtering-model-groups">Filtering model groups<a class="headerlink" href="#filtering-model-groups" title="Permanent link">#</a></h3>
<p><code>Audition</code> will generate two plots that are meant to be used together:
<em>model performance over time</em> and <em>distance from best</em>.</p>
<p><img alt="img" src="../images/audition/eis/metric_over_time_precision%4010_pct.png" />
<em>Figure. Model group performance over time. In this case the metric
show is <code>precision@10%</code>. The black dashed line represents the
(theoretical) system's performance if we select the best performant
model in a every evaluation date. The colored lines represents
different model groups. All the model groups that share an algorithm
will be colored the same.</em></p>
<p><img alt="img" src="../images/audition/eis/distance_from_best_precision%4010_pct.png" />
<em>Figure. Proportion of <strong>all</strong> the <strong>models</strong> in a <strong>model group</strong> that are
separated from the best model. The distance is measured in percentual
points, i.e. How much less precision at 10 percent of the population
compared to the best model in that date.</em></p>
<h3 id="selecting-the-best-rule-or-strategy-for-choosing-model-groups">Selecting the best rule or strategy for choosing model groups<a class="headerlink" href="#selecting-the-best-rule-or-strategy-for-choosing-model-groups" title="Permanent link">#</a></h3>
<p>In this phase of the audition, you will see what will happen in the
next time if you choose your model group with an specific strategy or
rule.</p>
<p>You then, can calculate the <em>regret</em>. <em>Regret</em> is defined as the
difference between the performance of the best model evaluated on the
"next time" and the performance of the model selected by a particular
rule.</p>
<p><img alt="img" src="../images/audition/eis/precision%4010_pct_next_time.png" />
<em>Figure. Given a
strategy for selecting model groups (in the plot 4 are shown), What
will be the performace of the model group chosen by that strategy in
the next evaluation date?</em></p>
<p><img alt="img" src="../images/audition/eis/regret_distance_from_best_rules_precision%4010_pct.png" />
<em>Figure. Given a strategy for selecting model groups (in the plot 4
are shown). What will be the distance (*regret</em>) to the best
theoretical model in the following evaluation date.*</p>
<p><img alt="img" src="../images/audition/eis/regret_over_time_precision%4010_pct.png" />
<em>Figure. Expected regret for the strategies. The less the better.</em></p>
<p>It seems that the <em>worst</em> strategy (the one with the bigger “regret”)
for selecting a <em>model_group</em> is
<code>lowest_metric_variance_precision</code>. The other three seem almost
indistinguishable. We will dig in using Postmodeling. And afterwards
instead of using the feature importance to characterize the
facilities, we will explore how the model is splitting the facilities
using <em>crosstabs</em>.</p>
<p>As before, the best <strong>3</strong> <em>model groups</em> per strategy will be stored
in the file <code>/triage/audition/eis/results_model_group_ids.json</code></p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;most_frequent_best_dist_precision@_10_pct_0.05&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="mi">15</span><span class="p">,</span>
<span class="w">        </span><span class="mi">16</span><span class="p">,</span>
<span class="w">        </span><span class="mi">17</span><span class="p">,</span>
<span class="w">        </span><span class="mi">9</span><span class="p">,</span>
<span class="w">        </span><span class="mi">18</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;lowest_metric_variance_precision@_10_pct&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="mi">2</span><span class="p">,</span>
<span class="w">        </span><span class="mi">5</span><span class="p">,</span>
<span class="w">        </span><span class="mi">19</span><span class="p">,</span>
<span class="w">        </span><span class="mi">11</span><span class="p">,</span>
<span class="w">        </span><span class="mi">6</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;best_average_value_precision@_10_pct&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="mi">15</span><span class="p">,</span>
<span class="w">        </span><span class="mi">16</span><span class="p">,</span>
<span class="w">        </span><span class="mi">17</span><span class="p">,</span>
<span class="w">        </span><span class="mi">18</span><span class="p">,</span>
<span class="w">        </span><span class="mi">9</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="nt">&quot;best_current_value_precision@_10_pct&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="mi">9</span><span class="p">,</span>
<span class="w">        </span><span class="mi">16</span><span class="p">,</span>
<span class="w">        </span><span class="mi">15</span><span class="p">,</span>
<span class="w">        </span><span class="mi">17</span><span class="p">,</span>
<span class="w">        </span><span class="mi">18</span>
<span class="w">    </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="postmodeling-inspecting-the-best-models-closely">Postmodeling: Inspecting the best models closely<a class="headerlink" href="#postmodeling-inspecting-the-best-models-closely" title="Permanent link">#</a></h2>
<p>Given that almost all the strategies perform well, we will change the
parameter <code>model_group_id</code> in the <a href="/triage/eis_postmodeling_config.yaml">postmodeling's configuration
file</a>
and we will use the complete set of model groups selected by audition:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Postmodeling Configuration File</span>

<span class="w">  </span><span class="nt">project_path</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;/triage&#39;</span><span class="w"> </span><span class="c1"># Project path defined in triage with matrices and models</span>
<span class="w">  </span><span class="nt">audition_output_path</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;/triage/audition/eis/results_model_group_ids.json&#39;</span>

<span class="w">  </span><span class="nt">thresholds</span><span class="p">:</span><span class="w"> </span><span class="c1"># Thresholds for2 defining positive predictions</span>
<span class="w">        </span><span class="nt">rank_abs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">50</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">100</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">250</span><span class="p p-Indicator">]</span>
<span class="w">        </span><span class="nt">rank_pct</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">5</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">10</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">25</span><span class="p p-Indicator">]</span>

<span class="w">  </span><span class="nt">baseline_query</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span><span class="w"> </span><span class="c1"># SQL query for defining a baseline for comparison in plots. It needs a metric and parameter</span>
<span class="w">      </span><span class="no">select g.model_group_id,</span>
<span class="w">             </span><span class="no">m.model_id,</span>
<span class="w">             </span><span class="no">extract(&#39;year&#39; from m.evaluation_end_time) as as_of_date_year,</span>
<span class="w">             </span><span class="no">m.metric,</span>
<span class="w">             </span><span class="no">m.parameter,</span>
<span class="w">             </span><span class="no">m.stochastic_value,</span>
<span class="w">             </span><span class="no">m.num_labeled_examples,</span>
<span class="w">             </span><span class="no">m.num_labeled_above_threshold,</span>
<span class="w">             </span><span class="no">m.num_positive_labels</span>
<span class="w">       </span><span class="no">from test_results.evaluations m</span>
<span class="w">       </span><span class="no">left join triage_metadata.models g</span>
<span class="w">       </span><span class="no">using(model_id)</span>
<span class="w">       </span><span class="no">where g.model_group_id = 20</span>
<span class="w">             </span><span class="no">and metric = &#39;precision@&#39;</span>
<span class="w">             </span><span class="no">and parameter = &#39;10_pct&#39;</span>

<span class="w">  </span><span class="nt">max_depth_error_tree</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span><span class="w"> </span><span class="c1"># For error trees, how depth the decision trees should go?</span>
<span class="w">  </span><span class="nt">n_features_plots</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span><span class="w"> </span><span class="c1"># Number of features for importances</span>
<span class="w">  </span><span class="nt">figsize</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">12</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">12</span><span class="p p-Indicator">]</span><span class="w"> </span><span class="c1"># Default size for plots</span>
<span class="w">  </span><span class="nt">fontsize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20</span><span class="w"> </span><span class="c1"># Default fontsize for plots</span>
</code></pre></div>
<p>Launch jupyter in <code>bastion</code>:</p>
<div class="highlight"><pre><span></span><code>jupyter-notebook<span class="w"> </span>–-ip<span class="o">=</span><span class="m">0</span>.0.0.0<span class="w">  </span>--port<span class="o">=</span><span class="m">56406</span><span class="w"> </span>--allow-root
</code></pre></div>
<p>And then in your browser location bar type: <a href="http://0.0.0.0:56406">http://0.0.0.0:56406</a></p>
<h3 id="setup">Setup<a class="headerlink" href="#setup" title="Permanent link">#</a></h3>
<div class="highlight"><pre><span></span><code>%matplotlib inline
import pandas as pd
import numpy as np
from collections import OrderedDict
from triage.component.postmodeling.contrast.utils.aux_funcs import create_pgconn, get_models_ids
from triage.component.catwalk.storage import ProjectStorage, ModelStorageEngine, MatrixStorageEngine
from triage.component.postmodeling.contrast.parameters import PostmodelParameters
from triage.component.postmodeling.contrast.model_evaluator import ModelEvaluator
from triage.component.postmodeling.contrast.model_group_evaluator import ModelGroupEvaluator

params = PostmodelParameters(&#39;../triage/eis_postmodeling_config.yaml&#39;)

engine = create_pgconn(&#39;database.yaml&#39;)

# Model group object (useful to compare across model_groups and models in time)
audited_models_class = ModelGroupEvaluator(tuple(params.model_group_id), engine)
</code></pre></div>
<h3 id="model-groups">Model groups<a class="headerlink" href="#model-groups" title="Permanent link">#</a></h3>
<p>Let’s start with the behavior in time of the selected model groups</p>
<div class="highlight"><pre><span></span><code>audited_models_class.plot_prec_across_time(param_type=&#39;rank_pct&#39;,
                                           param=10,
                                           baseline=True,
                                           baseline_query=params.baseline_query,
                                           metric=&#39;precision@&#39;,
                                           figsize=params.figsize)
</code></pre></div>
<p><img alt="img" src="../images/postmodeling/eis_mg_prec_over_time.png" title="Precision@10% over time from the best performing model groups selected by Audition" /></p>
<p>Every model selected by audition has a very similar performance across
time, and they are ~2.5 times above the baseline in precision@10%. We
could also check the recall of the model groups.</p>
<div class="highlight"><pre><span></span><code>audited_models_class.plot_prec_across_time(param_type=&#39;rank_pct&#39;,
                                           param=10,
                                           metric=&#39;recall@&#39;,
                                           figsize=params.figsize)
</code></pre></div>
<p><img alt="img" src="../images/postmodeling/eis_mg_recall_over_time.png" title="Recall@10% over time from the best performing model groups selected by Audition" /></p>
<p>That behavior is similar for the recall@10%, except for the model group <strong>69</strong></p>
<div class="highlight"><pre><span></span><code>audited_models_class.plot_jaccard_preds(param_type=&#39;rank_pct&#39;,
                                        param=10,
                                        temporal_comparison=True)
</code></pre></div>
<p><img alt="img" src="../images/postmodeling/eis_jaccard_on_lists_over_time.png" title="How similar are the model groups’ generated list? We use Jaccard similarity on the predicted lists (length of list 10%) to asses the overlap between lists." /></p>
<p>There are a high jaccard similarity between some model groups across
time. This could be an indicator that they are so similar that you can
choose any and it won’t matter.</p>
<h3 id="going-deeper-with-a-model">Going deeper with a model<a class="headerlink" href="#going-deeper-with-a-model" title="Permanent link">#</a></h3>
<p>We will choose the model group <strong>64</strong> as the winner.</p>
<div class="highlight"><pre><span></span><code><span class="k">select</span>
<span class="w">    </span><span class="n">mg</span><span class="p">.</span><span class="n">model_group_id</span><span class="p">,</span>
<span class="w">    </span><span class="n">mg</span><span class="p">.</span><span class="n">model_type</span><span class="p">,</span>
<span class="w">    </span><span class="n">mg</span><span class="p">.</span><span class="n">hyperparameters</span><span class="p">,</span>
<span class="w">    </span><span class="n">array_agg</span><span class="p">(</span><span class="n">model_id</span><span class="w"> </span><span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">train_end_time</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">models</span>
<span class="k">from</span>
<span class="w">    </span><span class="n">triage_metadata</span><span class="p">.</span><span class="n">model_groups</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">mg</span>
<span class="w">    </span><span class="k">inner</span><span class="w"> </span><span class="k">join</span>
<span class="w">    </span><span class="n">triage_metadata</span><span class="p">.</span><span class="n">models</span>
<span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="p">(</span><span class="n">model_group_id</span><span class="p">)</span>
<span class="k">where</span><span class="w"> </span><span class="n">model_group_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">76</span>
<span class="k">group</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span>
</code></pre></div>
<table>
<thead>
<tr>
<th>model<sub>group</sub><sub>id</sub></th>
<th>model<sub>type</sub></th>
<th>hyperparameters</th>
<th>models</th>
</tr>
</thead>
<tbody>
<tr>
<td>64</td>
<td>sklearn.ensemble.RandomForestClassifier</td>
<td>{"criterion": "gini", "max<sub>features</sub>": "sqrt", "n<sub>estimators</sub>": 500, "min<sub>samples</sub><sub>leaf</sub>": 1, "min<sub>samples</sub><sub>split</sub>": 50}</td>
<td>{190,208,226}</td>
</tr>
</tbody>
</table>
<p>But before going to production and start making predictions in unseen data, let’s see what the particular models are doing. <em>Postmodeling</em> created a <code>ModelEvaluator</code> (similar to the <code>ModelGroupEvaluator</code>) to do this exploration:</p>
<div class="highlight"><pre><span></span><code>models_76 = { f&#39;{model}&#39;: ModelEvaluator(76, model, engine) for model in [198,216,234] }
</code></pre></div>
<p>In this tutorial, we will just show some parts of the analysis in the most recent model, but feel free of exploring the behavior of all the models in this model group, and check if you can detect any pattern.</p>
<ul>
<li>
<p>Feature importances</p>
<div class="highlight"><pre><span></span><code>models_76[&#39;234&#39;].plot_feature_importances(path=params.project_path,
                                          n_features_plots=params.n_features_plots,
                                          figsize=params.figsize)
</code></pre></div>
<p><img alt="img" src="../images/postmodeling/eis_model_group_64_feature_importances.png" title="Top 10 feature importances for de model group 64 at 2017-12-01 (i.e. model 226)." /></p>
<div class="highlight"><pre><span></span><code>models_76[&#39;234&#39;].plot_feature_group_aggregate_importances()
</code></pre></div>
<p><img alt="img" src="../images/postmodeling/eis_model_group_64_feature_group_importances.png" title="Feature group “importance” (we are basically taking the max of all the feature importances in a feature group) for the model group 64, model 226." /></p>
</li>
</ul>
<h2 id="crosstabs-how-are-the-entities-classified">Crosstabs: How are the entities classified?<a class="headerlink" href="#crosstabs-how-are-the-entities-classified" title="Permanent link">#</a></h2>
<p>Model interpretation is a huge topic nowadays, the most obvious path
is using the <em>features importance</em> from the model. This could be
useful, but we could do a lot better.</p>
<p><code>Triage</code> uses <code>crosstabs</code> as a different approach that complements the
list of <em>features importance</em>. <code>crosstabs</code> will run statistical tests
to compare the predicted positive and the predicted false facilities
in <em>each</em> feature.</p>
<div class="highlight"><pre><span></span><code><span class="nt">output</span><span class="p">:</span>
<span class="w">  </span><span class="nt">schema</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;test_results&#39;</span>
<span class="w">  </span><span class="nt">table</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;eis_crosstabs&#39;</span>

<span class="nt">thresholds</span><span class="p">:</span>
<span class="w">    </span><span class="nt">rank_abs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">50</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">rank_pct</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">5</span><span class="p p-Indicator">]</span>

<span class="c1">#(optional): a list of entity_ids to subset on the crosstabs analysis</span>
<span class="nt">entity_id_list</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[]</span>

<span class="nt">models_list_query</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;select</span><span class="nv"> </span><span class="s">unnest(ARRAY[226])</span><span class="nv"> </span><span class="s">::</span><span class="nv"> </span><span class="s">int</span><span class="nv"> </span><span class="s">as</span><span class="nv"> </span><span class="s">model_id&quot;</span>

<span class="nt">as_of_dates_query</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;select</span><span class="nv"> </span><span class="s">generate_series(&#39;2017-12-01&#39;::date,</span><span class="nv"> </span><span class="s">&#39;2018-09-01&#39;::date,</span><span class="nv"> </span><span class="s">interval</span><span class="nv"> </span><span class="s">&#39;1month&#39;)</span><span class="nv">  </span><span class="s">as</span><span class="nv"> </span><span class="s">as_of_date&quot;</span>

<span class="c1">#don&#39;t change this query unless strictly necessary. It is just validating pairs of (model_id,as_of_date)</span>
<span class="c1">#it is just a join with distinct (model_id, as_of_date) in a predictions table</span>
<span class="nt">models_dates_join_query</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">  </span><span class="no">select model_id,</span>
<span class="w">  </span><span class="no">as_of_date</span>
<span class="w">  </span><span class="no">from models_list_query as m</span>
<span class="w">  </span><span class="no">cross join as_of_dates_query a join (select distinct model_id, as_of_date from test_results.predictions) as p</span>
<span class="w">  </span><span class="no">using (model_id, as_of_date)</span>

<span class="c1">#features_query must join models_dates_join_query with 1 or more features table using as_of_date</span>
<span class="nt">features_query</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">  </span><span class="no">select m.model_id, m.as_of_date, f4.entity_id, f4.results_entity_id_1month_result_fail_avg, f4.results_entity_id_3month_result_fail_avg, f4.results_entity_id_6month_result_fail_avg,</span>
<span class="w">  </span><span class="no">f2.inspection_types_entity_id_1month_type_canvass_sum, f3.risks_entity_id_1month_risk_high_sum, f4.results_entity_id_6month_result_pass_avg,</span>
<span class="w">  </span><span class="no">f3.risks_entity_id_all_risk_high_sum, f2.inspection_types_entity_id_3month_type_canvass_sum, f4.results_entity_id_6month_result_pass_sum,</span>
<span class="w">  </span><span class="no">f2.inspection_types_entity_id_all_type_canvass_sum</span>
<span class="w">  </span><span class="no">from features.inspection_types_aggregation_imputed as f2</span>
<span class="w">  </span><span class="no">inner join features.risks_aggregation_imputed as f3 using (entity_id, as_of_date)</span>
<span class="w">  </span><span class="no">inner join features.results_aggregation_imputed as f4 using (entity_id, as_of_date)</span>
<span class="w">  </span><span class="no">inner join models_dates_join_query as m using (as_of_date)</span>

<span class="c1">#the predictions query must return model_id, as_of_date, entity_id, score, label_value, rank_abs and rank_pct</span>
<span class="c1">#it must join models_dates_join_query using both model_id and as_of_date</span>
<span class="nt">predictions_query</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">  </span><span class="no">select model_id,</span>
<span class="w">      </span><span class="no">as_of_date,</span>
<span class="w">      </span><span class="no">entity_id,</span>
<span class="w">      </span><span class="no">score,</span>
<span class="w">      </span><span class="no">label_value,</span>
<span class="w">      </span><span class="no">coalesce(rank_abs_no_ties, row_number() over (partition by (model_id, as_of_date) order by score desc)) as rank_abs,</span>
<span class="w">      </span><span class="no">coalesce(rank_pct_no_ties*100, ntile(100) over (partition by (model_id, as_of_date) order by score desc)) as rank_pct</span>
<span class="w">      </span><span class="no">from test_results.predictions</span>
<span class="w">      </span><span class="no">join models_dates_join_query using(model_id, as_of_date)</span>
<span class="w">      </span><span class="no">where model_id in (select model_id from models_list_query)</span>
<span class="w">      </span><span class="no">and as_of_date in (select as_of_date from as_of_dates_query)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>triage<span class="w"> </span>--tb<span class="w"> </span>crosstabs<span class="w"> </span>/triage/eis_crosstabs_config.yaml
</code></pre></div>
<p>When it finishes, you could explore the table with the following code:</p>
<div class="highlight"><pre><span></span><code><span class="k">with</span><span class="w"> </span><span class="n">significant_features</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="p">(</span>
<span class="k">select</span>
<span class="w">    </span><span class="n">feature_column</span><span class="p">,</span>
<span class="w">    </span><span class="n">as_of_date</span><span class="p">,</span>
<span class="w">    </span><span class="n">threshold_unit</span>
<span class="k">from</span>
<span class="w">    </span><span class="n">test_results</span><span class="p">.</span><span class="n">eis_crosstabs</span>
<span class="k">where</span>
<span class="w">    </span><span class="n">metric</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;ttest_p&#39;</span>
<span class="w">    </span><span class="k">and</span>
<span class="w">    </span><span class="n">value</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">05</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">as_of_date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;2018-09-01&#39;</span>
<span class="w">    </span><span class="p">)</span>

<span class="k">select</span>
<span class="w">    </span><span class="k">distinct</span>
<span class="w">    </span><span class="n">model_id</span><span class="p">,</span>
<span class="w">    </span><span class="n">as_of_date</span><span class="p">::</span><span class="nb">date</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">as_of_date</span><span class="p">,</span>
<span class="w">    </span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;%s %s&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">threshold_value</span><span class="p">,</span><span class="w"> </span><span class="n">t1</span><span class="p">.</span><span class="n">threshold_unit</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">threshold</span><span class="p">,</span>
<span class="w">    </span><span class="n">feature_column</span><span class="p">,</span>
<span class="w">    </span><span class="n">value</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="ss">&quot;ratio PP / PN&quot;</span>
<span class="k">from</span>
<span class="w">    </span><span class="n">test_results</span><span class="p">.</span><span class="n">eis_crosstabs</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">t1</span>
<span class="w">    </span><span class="k">inner</span><span class="w"> </span><span class="k">join</span>
<span class="w">    </span><span class="n">significant_features</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">t2</span><span class="w"> </span><span class="k">using</span><span class="p">(</span><span class="n">feature_column</span><span class="p">,</span><span class="w"> </span><span class="n">as_of_date</span><span class="p">)</span>
<span class="k">where</span>
<span class="w">    </span><span class="n">metric</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;ratio_predicted_positive_over_predicted_negative&#39;</span>
<span class="w">    </span><span class="k">and</span>
<span class="w">    </span><span class="n">t1</span><span class="p">.</span><span class="n">threshold_unit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;pct&#39;</span>
<span class="k">order</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="k">desc</span>
</code></pre></div>
<table>
<thead>
<tr>
<th>model<sub>id</sub></th>
<th>as<sub>of</sub><sub>date</sub></th>
<th>threshold</th>
<th>feature<sub>column</sub></th>
<th>ratio PP / PN</th>
</tr>
</thead>
<tbody>
<tr>
<td>226</td>
<td>2018-09-01</td>
<td>5 pct</td>
<td>results<sub>entity</sub><sub>id</sub><sub>1month</sub><sub>result</sub><sub>fail</sub><sub>avg</sub></td>
<td>11.7306052855925</td>
</tr>
<tr>
<td>226</td>
<td>2018-09-01</td>
<td>5 pct</td>
<td>results<sub>entity</sub><sub>id</sub><sub>3month</sub><sub>result</sub><sub>fail</sub><sub>avg</sub></td>
<td>3.49082798996376</td>
</tr>
<tr>
<td>226</td>
<td>2018-09-01</td>
<td>5 pct</td>
<td>results<sub>entity</sub><sub>id</sub><sub>6month</sub><sub>result</sub><sub>fail</sub><sub>avg</sub></td>
<td>1.27344759545161</td>
</tr>
<tr>
<td>226</td>
<td>2018-09-01</td>
<td>5 pct</td>
<td>risks<sub>zip</sub><sub>code</sub><sub>1month</sub><sub>risk</sub><sub>high</sub><sub>sum</sub></td>
<td>1.17488357227451</td>
</tr>
<tr>
<td>226</td>
<td>2018-09-01</td>
<td>5 pct</td>
<td>inspection<sub>types</sub><sub>entity</sub><sub>id</sub><sub>all</sub><sub>type</sub><sub>canvass</sub><sub>sum</sub></td>
<td>0.946432281075976</td>
</tr>
<tr>
<td>226</td>
<td>2018-09-01</td>
<td>5 pct</td>
<td>inspection<sub>types</sub><sub>zip</sub><sub>code</sub><sub>3month</sub><sub>type</sub><sub>canvass</sub><sub>sum</sub></td>
<td>0.888940127100436</td>
</tr>
<tr>
<td>226</td>
<td>2018-09-01</td>
<td>5 pct</td>
<td>results<sub>entity</sub><sub>id</sub><sub>6month</sub><sub>result</sub><sub>pass</sub><sub>sum</sub></td>
<td>0.041806916457784</td>
</tr>
<tr>
<td>226</td>
<td>2018-09-01</td>
<td>5 pct</td>
<td>results<sub>entity</sub><sub>id</sub><sub>6month</sub><sub>result</sub><sub>pass</sub><sub>avg</sub></td>
<td>0.0232523724927717</td>
</tr>
</tbody>
</table>
<p>This table represents the ratio between the predicted positives at the top 5% and predicted negatives (the rest). For example, you can see that in PP are eleven times more inspected if they have a failed inspection in the last month, 3.5 times more if they have a failed inspection in the previous 3 months, etc.</p>
<h3 id="where-to-go-from-here">Where to go from here<a class="headerlink" href="#where-to-go-from-here" title="Permanent link">#</a></h3>
<p>Ready to get started with your own data? Check out <a href="https://dssg.github.io/triage/triage_project_workflow/">the suggested project workflow</a> for some tips about how to iterate and tune the pipeline for your project.</p>
<p>Want to work through another example? Take a look at our <a href="https://dssg.github.io/triage/dirtyduck/inspections/">resource prioritization case study</a></p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/dssg/triage" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/datascifellows" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://linkedin.com/company/center-for-data-science-and-public-policy-university-of-chicago" target="_blank" rel="noopener" title="linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.aecac24b.min.js"></script>
      
        <script src="../../js/mermaid.min.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
  </body>
</html>